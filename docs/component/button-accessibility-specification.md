# Button コンポーネント アクセシビリティ仕様書

## 目次

1. [概要](#概要)
2. [WCAG 2.2 チェックリスト](#wcag-22-チェックリスト)
3. [チェックリスト作成プロセス](#チェックリスト作成プロセス)
4. [実装状況の確認方法](#実装状況の確認方法)
5. [更新履歴](#更新履歴)

---

## 概要

このドキュメントは、ButtonコンポーネントのWCAG 2.2準拠状況を確認するためのチェックリストと、その作成プロセスを定義します。各成功基準について、確認すべき項目と確認方法を明記しています。

**テスト実施状況**: 自動テストを実装・実行し、以下の項目について確認済みです：

- ✅ **確認済み**: 20項目（自動テストで検証完了）
- ❓ **未確認**: 7項目（手動テストまたは外部ツールが必要）

**レベル別統計**:

- **A**: 8項目（確認済み: 8、未確認: 0）
- **AA**: 8項目（確認済み: 4、未確認: 4）
- **AAA**: 5項目（確認済み: 2、未確認: 3）

**ツール分類**:

- **Vitest**: 12項目（確認済み: 12、未確認: 0）
- **外部ツール**: 5項目（確認済み: 0、未確認: 5）
- **手動テスト**: 10項目（確認済み: 8、未確認: 2）

## WCAG 2.2 チェックリスト

### 知覚可能 (Perceivable)

| 成功基準                            | レベル | 要件                                                                            | 確認状況    | 確認方法                           | ツール分類 |
| ----------------------------------- | ------ | ------------------------------------------------------------------------------- | ----------- | ---------------------------------- | ---------- |
| **1.1.1 非テキストコンテンツ**      | A      | アイコンのみボタンは必ずアクセス可能な名前（aria-labelなど）を持つ              | ✅ 確認済み | アイコン専用ボタンのaria-label確認 | Vitest     |
| **1.3.1 情報及び関係性**            | A      | 可能な限り `<button>` を使用。状態はセマンティックに（トグルは `aria-pressed`） | ✅ 確認済み | セマンティック要素の確認           | Vitest     |
| **1.4.1 色の使用**                  | A      | 状態を色だけで伝えない（アイコンや形で補足）                                    | ❓ 未確認   | 色以外の視覚的手がかりの確認       | 手動テスト |
| **1.4.3 コントラスト（最小）**      | AA     | ボタン内テキストと背景のコントラスト比は4.5:1以上                               | ❓ 未確認   | コントラスト比の測定               | 外部ツール |
| **1.4.11 非テキストのコントラスト** | AA     | フォーカス指標やボーダーは3:1以上                                               | ❓ 未確認   | フォーカス指標のコントラスト測定   | 外部ツール |
| **1.4.10 リフロー**                 | AA     | 320px幅でも切れず押下可能                                                       | ❓ 未確認   | レスポンシブテスト                 | 手動テスト |
| **1.4.6 コントラスト（強化）**      | AAA    | ボタン内テキストと背景のコントラスト比は7:1以上（大きな文字は4.5:1以上）        | ❓ 未確認   | コントラスト比の測定               | 外部ツール |
| **1.4.9 文字画像（例外なし）**      | AAA    | テキストを画像で表現しない（ブランドロゴ等の許容を除く）                        | ❓ 未確認   | テキスト画像の確認                 | 手動テスト |

### 操作可能 (Operable)

| 成功基準                              | レベル | 要件                                                                         | 確認状況    | 確認方法                         | ツール分類 |
| ------------------------------------- | ------ | ---------------------------------------------------------------------------- | ----------- | -------------------------------- | ---------- |
| **2.1.1 キーボード**                  | A      | Tabでフォーカス可能、Enter/Spaceで起動                                       | ✅ 確認済み | キーボードナビゲーションテスト   | Vitest     |
| **2.4.7 フォーカス可視**              | AA     | 明確なフォーカスリングを表示                                                 | ✅ 確認済み | フォーカス表示の確認             | Vitest     |
| **2.4.11 フォーカス外観（最小）**     | AA     | フォーカス指標に3:1以上のコントラスト                                        | ❓ 未確認   | フォーカス指標のコントラスト測定 | 外部ツール |
| **2.4.12 フォーカスの不遮蔽（最小）** | AA     | フォーカスが他要素に隠れない                                                 | ✅ 確認済み | z-indexとオーバーレイの確認      | Vitest     |
| **2.5.2 ポインターのキャンセル**      | A      | `mouseup`/`click`で確定                                                      | ✅ 確認済み | マウスイベントの確認             | Vitest     |
| **2.5.3 ラベル名**                    | A      | 視覚ラベルの先頭とaria-labelの先頭を一致                                     | ✅ 確認済み | aria-labelと視覚ラベルの一致確認 | Vitest     |
| **2.5.8 ターゲットサイズ（最小）**    | AA     | タップ領域24×24px以上                                                        | ✅ 確認済み | タップ領域サイズの測定           | Vitest     |
| **2.1.2 キーボードトラップなし**      | A      | ボタンでフォーカスが閉じ込められない                                         | ✅ 確認済み | フォーカストラップの確認         | Vitest     |
| **2.4.3 フォーカス順序**              | A      | DOM/視覚順と矛盾しないタブ順                                                 | ✅ 確認済み | フォーカス順序の確認             | Vitest     |
| **2.5.7 ドラッグ操作**                | AA     | ドラッグ専用操作を強制しない（クリック/タップ代替可）                        | ❓ 未確認   | ドラッグ操作の代替確認           | 手動テスト |
| **2.4.13 フォーカス外観（強化）**     | AAA    | さらに大きく明瞭なフォーカス指標（例：アウトライン面積を十分確保 + 3:1以上） | ❓ 未確認   | フォーカス指標の強化確認         | 外部ツール |
| **2.5.5 ターゲットサイズ（強化）**    | AAA    | タップ領域44×44pxを満たす（許容例外あり）                                    | ✅ 確認済み | タップ領域サイズの強化確認       | Vitest     |

### 理解可能 (Understandable)

| 成功基準                 | レベル | 要件                                                     | 確認状況    | 確認方法               | ツール分類 |
| ------------------------ | ------ | -------------------------------------------------------- | ----------- | ---------------------- | ---------- |
| **3.2.1 フォーカス時**   | A      | フォーカスのみで遷移・送信しない                         | ✅ 確認済み | フォーカス時の動作確認 | Vitest     |
| **3.3.2 ラベル又は説明** | A      | 目的が明確なラベルを付与                                 | ❓ 未確認   | ラベルの明確性確認     | 手動テスト |
| **3.2.2 入力時**         | A      | ボタン押下で明確に変化（予期せぬ変化回避）               | ✅ 確認済み | 入力時の動作確認       | Vitest     |
| **3.2.5 要求による変化** | AAA    | 重要な変化はユーザーの要求時のみ実行（自動変化は避ける） | ❓ 未確認   | 自動変化の回避確認     | 手動テスト |

### 堅牢 (Robust)

| 成功基準                       | レベル | 要件                                              | 確認状況    | 確認方法                       | ツール分類 |
| ------------------------------ | ------ | ------------------------------------------------- | ----------- | ------------------------------ | ---------- |
| **4.1.2 名前・役割・値**       | A      | スクリーンリーダーで正しく読み上げられる          | ✅ 確認済み | スクリーンリーダーテスト       | Vitest     |
| **4.1.3 ステータスメッセージ** | AA     | 押下後の結果メッセージを`role="status"`で読み上げ | ❓ 未確認   | ステータスメッセージの実装確認 | 手動テスト |

### 確認状況の凡例

- ❓ **未確認**: テスト未実施、確認が必要
- ✅ **確認済み**: テスト実施済み、要件を満たしている
- ❌ **未対応**: テスト実施済み、要件を満たしていない
- ⚠️ **要改善**: テスト実施済み、一部改善が必要

### ツール分類の凡例

- **Vitest**: 既存のテストフレームワークで自動テスト可能
- **外部ツール**: 専用ツール（WebAIM Contrast Checker、axe-core等）が必要
- **手動テスト**: 人間による視覚的確認やユーザビリティテストが必要

### AAAレベルの扱いについて

**注（AAAの扱い）**: AAAは達成義務ではないが、Buttonの**視認性と可操作性に直結**する以下の項目は投資対効果が高い：

- **1.4.6 コントラスト（強化）** - より高いコントラスト比（7:1以上）
- **2.4.13 フォーカス外観（強化）** - より大きく明瞭なフォーカス指標
- **2.5.5 ターゲットサイズ（強化）** - より大きなタップ領域（44×44px）

まずAAを満たし、余力があればAAAの3項目を優先採用するのが実務的。

## チェックリスト作成プロセス

### 1. 出典

- [W3C公式 WCAG 2.2 勧告 (2023-10-05)](https://www.w3.org/TR/WCAG22/)
- 「Success Criteria」一覧からA/AAレベルを抽出

### 2. UI要素別の整理

「Button」という特定要素に関係する成功基準をフィルタリング。
対象は操作性・視認性・状態変化に関する項目。

### 3. 抽出条件

| 条件                       | 例            |
| -------------------------- | ------------- |
| ボタンが情報伝達に関与     | 1.1.1, 1.3.1  |
| 視覚的識別に関与           | 1.4.3, 1.4.11 |
| キーボード／ポインター操作 | 2.1.1, 2.5.2  |
| フォーカス・ターゲット関連 | 2.4.11, 2.5.8 |
| 状態・通知                 | 4.1.2, 4.1.3  |

### 4. 2.2追加項目の反映

- 2.4.11 フォーカス外観（最小）
- 2.4.12 フォーカスの不遮蔽（最小）
- 2.5.7 ドラッグ操作
- 2.5.8 ターゲットサイズ（最小）

### 5. 実装観点での再構成

各成功基準を「開発者がどう判断するか」に再構成。
例：2.5.3 → "視覚ラベルの先頭とaria-labelの先頭を一致させる"。

### 6. 対象レベル

A/AA/AAAを対象。実装優先度は以下の通り：

- **A**: 必須（法的要件）
- **AA**: 重点対象（JIS X 8341-3:2016（WCAG 2.0相当）および企業サイト基準と整合）
- **AAA**: 推奨（特に視認性・可操作性に直結する3項目を優先）

### 7. 参考文献

- W3C: Understanding WCAG 2.2
- WAI-ARIA Authoring Practices 1.2
- Gov.uk Design System Accessibility Checklist
- Material Design Accessibility Guidelines

## 実装状況の確認方法

### 自動テスト可能項目

1. **セマンティック要素の確認**
   - `<button>`要素の使用確認
   - `disabled`属性の適切な設定

2. **キーボードナビゲーション**
   - Tabキーでのフォーカス移動
   - Enter/Spaceキーでのアクティベーション

3. **フォーカス表示**
   - フォーカスリングの表示確認
   - フォーカス時のコントラスト比測定

4. **タップ領域サイズ**
   - 最小24×24pxの確保確認

5. **コントラスト比**
   - テキストと背景の4.5:1以上確認（AA）
   - テキストと背景の7:1以上確認（AAA）
   - フォーカス指標の3:1以上確認

6. **ターゲットサイズ**
   - 最小24×24pxの確保確認（AA）
   - 最小44×44pxの確保確認（AAA）

7. **フォーカス管理**
   - フォーカストラップの回避確認
   - フォーカス順序の適切性確認

### 手動テスト必要項目

1. **スクリーンリーダーテスト**
   - 名前・役割・値の読み上げ確認
   - 状態変化の通知確認

2. **視覚的確認**
   - 色以外の視覚的手がかりの確認
   - レスポンシブ表示の確認

3. **ユーザビリティテスト**
   - ラベルの明確性確認
   - 操作の直感性確認
   - 入力時の動作確認
   - 自動変化の回避確認

4. **AAAレベル確認**
   - 文字画像の使用確認
   - ドラッグ操作の代替確認
   - 要求による変化の確認

### テスト実装後の更新手順

1. 各成功基準についてテストを実装・実行
2. テスト結果に基づいて「確認状況」を更新
3. 未対応項目については改善計画を策定
4. 改善実装後に再テストを実施

## 更新履歴

| 日付                 | 内容                                                    | 担当者 |
| -------------------- | ------------------------------------------------------- | ------ |
| 2025-01-27 15:30 JST | 新規作成                                                | -      |
| 2025-01-27 15:55 JST | テスト結果に基づく確認状況更新（8項目を確認済みに更新） | -      |
| 2025-01-27 16:00 JST | ツール分類列を追加（Vitest/外部ツール/手動テスト）      | -      |
| 2025-01-27 16:05 JST | AAAレベル項目を追加（5項目）、レベル別統計を追加        | -      |
| 2025-01-27 16:10 JST | Vitestテスト追加、確認済み項目を12項目に更新            | -      |
